(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{1401:function(e,t,a){Promise.resolve().then(a.bind(a,7907)),Promise.resolve().then(a.bind(a,6838)),Promise.resolve().then(a.bind(a,1222)),Promise.resolve().then(a.bind(a,5681)),Promise.resolve().then(a.t.bind(a,4742,23)),Promise.resolve().then(a.t.bind(a,7960,23))},7907:function(e,t,a){"use strict";a.d(t,{default:function(){return v}});var r=a(7437),s=a(9763);let i=(0,s.Z)("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),l=(0,s.Z)("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),n=(0,s.Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),o=(0,s.Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);var d=a(2489),c=a(7081),u=a(3541),m=a(2265),h=a(605),x=a(7648),f=a(9376),p=a(5681),y=a(9048),g=a(2595);function v(){var e,t;let[a,s]=(0,m.useState)(!1),[v,b]=(0,m.useState)(!1),{notifications:j,unreadCount:N,markAsRead:w,clearNotification:k}=(0,c.z)(),{data:M}=(0,h.useSession)(),S=(0,f.usePathname)(),{itemCount:A,items:C,removeItem:I,clearCart:P,formData:E}=(0,p.j)(),[D,Z]=(0,m.useState)(!1),T=(0,f.useRouter)(),[_,z]=(0,m.useState)(!1),O=C.reduce((e,t)=>e+t.amount,0),F=async()=>{if(0!==C.length&&(null==M?void 0:M.user)){if(!E){alert("Por favor complete el formulario de informaci\xf3n adicional primero.");return}if(!E.customerName.trim()){alert("Por favor ingrese el nombre del cliente.");return}z(!0);try{var e;let t=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"}});if(!t.ok)throw Error("Failed to create order");let a=await t.json();for(let e of(console.log("Order created:",a),await new Promise(e=>setTimeout(e,1e3)),C))await fetch("/api/leases",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mediaSpaceId:e.spaceId,customerName:E.customerName,startDate:e.startDate,endDate:e.endDate,amount:e.amount,statusId:1,orderId:a.id,extraInformation:{providerInfo:E.providerInfo,productDetails:E.productDetails,campaignRedirect:E.campaignRedirect,marketingGoals:E.marketingGoals,disclaimer:E.disclaimer,productUrl:E.productUrl,targetAudience:E.targetAudience,brandGraphics:E.brandGraphics||"",providerContact:E.providerContact,billingType:E.billingType,giftCampaignDetails:E.giftCampaignDetails||"",planAlaMedida:E.planAlaMedida||"",planAlaMedidaAmount:E.planAlaMedidaAmount||""}})});P(),Z(!1),(null==M?void 0:null===(e=M.user)||void 0===e?void 0:e.role)==="ADVERTISER"?T.push("/leasing/my-leases"):T.push("/leasing/history")}catch(e){console.error("Error creating order:",e),alert("Error al crear la solicitud. Por favor intente nuevamente.")}finally{z(!1)}}};return(0,r.jsxs)("header",{className:"bg-white shadow-sm",children:[(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)("div",{className:"flex justify-between h-16",children:[(0,r.jsx)("div",{className:"flex",children:(0,r.jsx)("div",{className:"flex-shrink-0 flex items-center",children:(0,r.jsx)("h1",{className:"text-xl font-bold",children:"Gestor de Medios Publicitarios"})})}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:["/leasing"===S&&(0,r.jsxs)("button",{className:"p-2 text-gray-600 hover:text-gray-900 relative",onClick:()=>Z(!0),children:[(0,r.jsx)(i,{className:"h-6 w-6"}),A>0&&(0,r.jsx)("span",{className:"absolute -top-1 -right-1 bg-blue-500 text-white rounded-full w-5 h-5 text-xs flex items-center justify-center",children:A})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("button",{onClick:()=>{s(!a),a||j.forEach(e=>{e.read||w(e.id)})},className:"p-2 hover:bg-gray-100 rounded-full relative",children:[(0,r.jsx)(l,{className:"h-6 w-6"}),N>0&&(0,r.jsx)("span",{className:"absolute top-0 right-0 bg-red-500 text-white rounded-full w-5 h-5 text-xs flex items-center justify-center",children:N})]}),a&&(0,r.jsx)("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 max-h-96 overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Notificaciones"}),0===j.length?(0,r.jsx)("p",{className:"text-gray-500",children:"No hay notificaciones"}):(0,r.jsx)("div",{className:"space-y-2",children:j.map(e=>(0,r.jsxs)("div",{className:"p-3 rounded-lg ".concat(e.read?"bg-gray-50":"bg-blue-50"),children:[(0,r.jsx)("p",{className:"text-sm",children:e.message}),(0,r.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,r.jsx)("span",{className:"text-xs text-gray-500",children:(0,u.Z)(e.timestamp,"MMM d, h:mm a")}),(0,r.jsx)("button",{onClick:()=>k(e.id),className:"text-xs text-gray-400 hover:text-gray-600",children:"Eliminar"})]})]},e.id))})]})})]}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("button",{onClick:()=>b(!v),className:"p-2 hover:bg-gray-100 rounded-full flex items-center gap-2",children:[(0,r.jsx)(n,{className:"h-6 w-6"}),(null==M?void 0:null===(e=M.user)||void 0===e?void 0:e.name)&&(0,r.jsx)("span",{className:"text-sm font-medium",children:M.user.name})]}),v&&(0,r.jsx)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200",children:(0,r.jsx)("div",{className:"p-2",children:(null==M?void 0:null===(t=M.user)||void 0===t?void 0:t.role)==="ADMIN"?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"px-4 py-2 text-sm text-gray-500",children:["Conectado como",(0,r.jsx)("br",{}),(0,r.jsx)("span",{className:"font-medium text-gray-900",children:M.user.email})]}),(0,r.jsx)("div",{className:"border-t border-gray-100 my-1"}),(0,r.jsx)(x.default,{href:"/register",className:"block px-4 py-2 text-sm text-blue-600 hover:bg-blue-50 rounded-md",children:"Crear Usuario"}),(0,r.jsxs)("button",{onClick:()=>(0,h.signOut)(),className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md flex items-center gap-2",children:[(0,r.jsx)(o,{className:"h-4 w-4"}),"Cerrar Sesi\xf3n"]})]}):(null==M?void 0:M.user)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"px-4 py-2 text-sm text-gray-500",children:["Conectado como",(0,r.jsx)("br",{}),(0,r.jsx)("span",{className:"font-medium text-gray-900",children:M.user.email})]}),(0,r.jsx)("div",{className:"border-t border-gray-100 my-1"}),(0,r.jsxs)("button",{onClick:()=>(0,h.signOut)(),className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 rounded-md flex items-center gap-2",children:[(0,r.jsx)(o,{className:"h-4 w-4"}),"Cerrar Sesi\xf3n"]})]}):(0,r.jsx)(x.default,{href:"/login",className:"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 rounded-md",children:"Sign in"})})})]})]})]})}),D&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-[800px] w-full shadow-xl",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h3",{className:"text-lg font-medium",children:"Carrito de Solicitudes"}),(0,r.jsx)("button",{onClick:()=>Z(!1),className:"text-gray-500 hover:text-gray-700",children:(0,r.jsx)(d.Z,{className:"h-5 w-5"})})]}),C.length>0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"space-y-4 mb-6",children:C.map((e,t)=>(0,r.jsxs)("div",{className:"flex justify-between items-center p-4 border rounded-lg",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium",children:e.mediaType}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:e.storeName}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,u.Z)(e.startDate,"d MMM",{locale:y.Z})," - ",(0,u.Z)(e.endDate,"d MMM yyyy",{locale:y.Z})]}),(0,r.jsxs)("p",{className:"text-sm font-medium",children:["$",e.amount.toLocaleString()]})]}),(0,r.jsx)("button",{onClick:()=>I(e.spaceId),className:"text-red-500 hover:text-red-700",children:(0,r.jsx)(d.Z,{className:"h-5 w-5"})})]},t))}),(0,r.jsxs)("div",{className:"border-t pt-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("span",{className:"font-medium",children:"Total:"}),(0,r.jsxs)("span",{className:"font-medium",children:["$",O.toLocaleString()]})]}),(0,r.jsx)(g.z,{className:"w-full bg-blue-600 hover:bg-blue-700 text-white",onClick:F,disabled:_,children:_?"Procesando...":"Confirmar Solicitud"})]})]}):(0,r.jsx)("div",{className:"text-center py-6 text-gray-500",children:"No hay items en el carrito"})]})})]})}},6838:function(e,t,a){"use strict";a.d(t,{Navigation:function(){return h}});var r=a(7437),s=a(7648),i=a(9376),l=a(9763);let n=(0,l.Z)("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]),o=(0,l.Z)("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]),d=(0,l.Z)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);var c=a(8728);let u=(0,l.Z)("GitPullRequest",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["line",{x1:"6",x2:"6",y1:"9",y2:"21",key:"rroup"}]]);var m=a(605);function h(){let e=(0,i.usePathname)(),{data:t}=(0,m.useSession)(),a=(null==t?void 0:t.user)?"ADVERTISER"===t.user.role?[{href:"/leasing",label:"Solicitud",icon:n},{href:"/leasing/my-leases",label:"Mis Solicitudes",icon:o}]:[{href:"/dashboard",label:"Panel Principal",icon:d,roles:["ADMIN","ASSOCIATE"]},{href:"/leasing",label:"Solicitud",icon:n,roles:["ADMIN","ASSOCIATE"]},{href:"/manage",label:"Administrar",icon:c.Z,roles:["ADMIN","ASSOCIATE"]},{href:"/leasing/history",label:"Historial",icon:o,roles:["ADMIN","ASSOCIATE"]},{name:"Pipeline",href:"/pipedrive",label:"Pipeline",icon:u,roles:["ADMIN","ASSOCIATE"]}].filter(e=>e.roles.includes(t.user.role)):[];return(0,r.jsx)("nav",{className:"flex flex-col gap-4 p-4",children:a.map(t=>{let{href:a,label:i,icon:l}=t,n=e===a;return(0,r.jsxs)(s.default,{href:a,className:"\n              flex items-center gap-2 px-4 py-2 rounded-lg\n              transition-colors duration-200\n              ".concat(n?"bg-blue-100 text-blue-700":"text-gray-600 hover:bg-gray-100","\n            "),children:[(0,r.jsx)(l,{className:"h-5 w-5"}),(0,r.jsx)("span",{children:i})]},a)})})}},1222:function(e,t,a){"use strict";a.d(t,{Providers:function(){return d}});var r=a(7437),s=a(605),i=a(2265);let l=(0,i.createContext)(void 0),n=e=>{let{children:t}=e,[a,s]=(0,i.useState)([]),[n,o]=(0,i.useState)(!0),[d,c]=(0,i.useState)(null);return(0,i.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/media"),t=await e.json();s(t),o(!1)}catch(e){c("Failed to fetch media data"),o(!1)}})()},[]),(0,r.jsx)(l.Provider,{value:{media:a,setMedia:s,loading:n,error:d},children:t})};var o=a(7081);function d(e){let{children:t}=e;return(0,r.jsx)(s.SessionProvider,{children:(0,r.jsx)(n,{children:(0,r.jsx)(o.J,{children:t})})})}},2595:function(e,t,a){"use strict";a.d(t,{z:function(){return l}});var r=a(7437),s=a(2265),i=a(4508);let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("button",{className:(0,i.cn)("inline-flex items-center justify-center rounded-md text-sm font-medium bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2",a),ref:t,...s})});l.displayName="Button"},5681:function(e,t,a){"use strict";a.d(t,{CartProvider:function(){return l},j:function(){return n}});var r=a(7437),s=a(2265);let i=(0,s.createContext)({items:[],itemCount:0,addItem:()=>{},removeItem:()=>{},clearCart:()=>{},formData:null,setFormData:()=>{}});function l(e){let{children:t}=e,[a,l]=(0,s.useState)([]),[n,o]=(0,s.useState)(null);return(0,r.jsx)(i.Provider,{value:{items:a,formData:n,addItem:e=>{var t,a;console.log("Adding item to cart with planAlaMedida:",{planAlaMedida:e.extraInformation.planAlaMedida,planAlaMedidaAmount:e.extraInformation.planAlaMedidaAmount});let r={...e,extraInformation:{...e.extraInformation,planAlaMedida:null!==(t=e.extraInformation.planAlaMedida)&&void 0!==t?t:null,planAlaMedidaAmount:null!==(a=e.extraInformation.planAlaMedidaAmount)&&void 0!==a?a:null}};console.log("Processed cart item:",r),l(e=>[...e,r])},removeItem:e=>{l(t=>t.filter(t=>t.spaceId!==e))},clearCart:()=>{l([])},setFormData:o,itemCount:a.length},children:t})}function n(){let e=(0,s.useContext)(i);if(void 0===e)throw Error("useCart must be used within a CartProvider");return e}},7081:function(e,t,a){"use strict";a.d(t,{J:function(){return n},z:function(){return o}});var r=a(7437),s=a(2265);let i=(0,s.createContext)(void 0),l={"Lease successfully created":"Solicitud creada exitosamente","Failed to create lease":"Error al crear la solicitud","Lease successfully revoked":"Solicitud revocada exitosamente","Failed to revoke lease":"Error al revocar la solicitud","Store updated successfully":"Tienda actualizada exitosamente","Failed to update store":"Error al actualizar la tienda","Media space updated":"Espacio publicitario actualizado","Failed to update media space":"Error al actualizar el espacio publicitario"};function n(e){let{children:t}=e,[a,n]=(0,s.useState)([]),o=a.filter(e=>!e.read).length;return(0,r.jsx)(i.Provider,{value:{notifications:a,addNotification:e=>{let t=l[e]||e,a={id:Date.now().toString(),message:t,timestamp:new Date,read:!1};n(e=>[a,...e])},markAsRead:e=>{n(t=>t.map(t=>t.id===e?{...t,read:!0}:t))},clearNotification:e=>{n(t=>t.filter(t=>t.id!==e))},unreadCount:o},children:t})}let o=()=>{let e=(0,s.useContext)(i);if(void 0===e)throw Error("useNotifications must be used within a NotificationProvider");return e}},4508:function(e,t,a){"use strict";a.d(t,{cn:function(){return i}});var r=a(1994),s=a(3335);function i(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.m6)((0,r.W)(t))}},8728:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},2489:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},7960:function(){},4742:function(e){e.exports={style:{fontFamily:"'__Inter_d65c78', '__Inter_Fallback_d65c78'",fontStyle:"normal"},className:"__className_d65c78"}}},function(e){e.O(0,[540,554,605,541,457,971,117,744],function(){return e(e.s=1401)}),_N_E=e.O()}]);