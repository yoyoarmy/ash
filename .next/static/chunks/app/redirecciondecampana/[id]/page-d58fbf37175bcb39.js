(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[607],{9883:function(e,t,a){Promise.resolve().then(a.bind(a,6561))},4935:function(e,t,a){"use strict";a.d(t,{p:function(){return s}});var r=a(7437),n=a(5863);function s(){return(0,r.jsxs)("div",{className:"h-screen flex flex-col items-center justify-center",children:[(0,r.jsx)(n.Z,{className:"h-8 w-8 animate-spin text-blue-500"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Loading..."})]})}},2443:function(e,t,a){"use strict";a.d(t,{p:function(){return c}});var r=a(7437),n=a(605),s=a(9376),i=a(4935);function c(e){let{children:t,allowedRoles:a}=e,{data:c,status:l}=(0,n.useSession)();return"loading"===l?(0,r.jsx)(i.p,{}):((null==c?void 0:c.user)&&a.includes(c.user.role)||(0,s.redirect)("/leasing"),(0,r.jsx)(r.Fragment,{children:t}))}},2595:function(e,t,a){"use strict";a.d(t,{z:function(){return i}});var r=a(7437),n=a(2265),s=a(4508);let i=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("button",{className:(0,s.cn)("inline-flex items-center justify-center rounded-md text-sm font-medium bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2",a),ref:t,...n})});i.displayName="Button"},4029:function(e,t,a){"use strict";a.d(t,{Ol:function(){return c},Zb:function(){return i},aY:function(){return d},ll:function(){return l}});var r=a(7437),n=a(2265),s=a(4508);let i=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...n})});i.displayName="Card";let c=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("flex flex-col space-y-1.5 p-6",a),...n})});c.displayName="CardHeader";let l=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("h3",{ref:t,className:(0,s.cn)("text-2xl font-semibold leading-none tracking-tight",a),...n})});l.displayName="CardTitle";let d=n.forwardRef((e,t)=>{let{className:a,...n}=e;return(0,r.jsx)("div",{ref:t,className:(0,s.cn)("p-6 pt-0",a),...n})});d.displayName="CardContent"},6561:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return u}});var r=a(7437),n=a(2265),s=a(9376),i=a(2595),c=a(4029),l=a(4935),d=a(2443),o=a(605);function u(){let{data:e}=(0,o.useSession)();(0,s.useRouter)();let t=(0,s.useParams)(),[a,u]=(0,n.useState)(null),[m,f]=(0,n.useState)(!0),[h,x]=(0,n.useState)(!1),[p,y]=(0,n.useState)("");(0,n.useEffect)(()=>{let e=async()=>{try{let e=await fetch("/api/leases/".concat(t.id));if(!e.ok)throw Error("Lease not found");let a=await e.json();u(a),y(placeholder="Producto que se desea destacar dentro de la marca (Nombre + SKU)")}catch(e){console.error("Error fetching lease:",e)}finally{f(!1)}};t.id&&e()},[t.id]);let N=async()=>{if(a){x(!0);try{if(!(await fetch("/api/leases/".concat(a.id,"/redirect"),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({campaignRedirect:p})})).ok)throw Error("Failed to update");await fetch("/api/leases/".concat(a.id,"/notify"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({lease:a,redirectUrl:p})}),u(e=>e?{...e,extraInformation:{...e.extraInformation,campaignRedirect:p}}:null),alert("Redirecci\xf3n de Campa\xf1a actualizada exitosamente")}catch(e){console.error("Error updating lease:",e),alert("Error al actualizar la redirecci\xf3n")}finally{x(!1)}}};return m?(0,r.jsx)(l.p,{}):a?(0,r.jsx)(d.p,{allowedRoles:["ADMIN","ASSOCIATE"],children:(0,r.jsx)("div",{className:"min-h-screen p-6 bg-white",children:(0,r.jsx)("div",{className:"max-w-2xl mx-auto bg-white",children:(0,r.jsxs)(c.Zb,{children:[(0,r.jsx)(c.Ol,{className:"bg-white",children:(0,r.jsx)(c.ll,{children:"Actualizar Redirecci\xf3n de Campa\xf1a"})}),(0,r.jsxs)(c.aY,{className:"space-y-4 bg-white",children:[(0,r.jsxs)("div",{className:"space-y-2 bg-white",children:[(0,r.jsx)("h3",{className:"font-medium",children:"Detalles de la Solicitud"}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Lease #",a.id]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Cliente: ",a.customerName]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Tienda: ",a.mediaSpace.store.name]}),(0,r.jsxs)("p",{className:"text-sm text-gray-600",children:["Tipo de Medio: ",a.mediaSpace.mediaItem.type]})]}),(0,r.jsxs)("div",{className:"space-y-2 bg-white",children:[(0,r.jsx)("label",{className:"text-sm font-medium",children:"Redirecci\xf3n de Campa\xf1a"}),(0,r.jsx)("div",{className:"flex flex-col gap-4",children:(0,r.jsx)("input",{type:"url",value:p,onChange:e=>y(e.target.value),placeholder:"Ingrese la URL de redirecci\xf3n",className:"w-full px-3 py-2 border rounded-md"})})]}),(0,r.jsx)(i.z,{onClick:N,disabled:h,className:"w-full",children:h?"Actualizando...":"Actualizar Redirecci\xf3n"})]})]})})})}):(0,r.jsx)("div",{className:"p-6 bg-white",children:"Lease not found"})}},4508:function(e,t,a){"use strict";a.d(t,{cn:function(){return s}});var r=a(1994),n=a(3335);function s(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,n.m6)((0,r.W)(t))}},5863:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});let r=(0,a(9763).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},9376:function(e,t,a){"use strict";var r=a(5475);a.o(r,"redirect")&&a.d(t,{redirect:function(){return r.redirect}}),a.o(r,"useParams")&&a.d(t,{useParams:function(){return r.useParams}}),a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})}},function(e){e.O(0,[554,605,971,117,744],function(){return e(e.s=9883)}),_N_E=e.O()}]);