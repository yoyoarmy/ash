(()=>{var e={};e.id=8881,e.ids=[8881],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},72349:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>c,routeModule:()=>x,tree:()=>d}),a(83848),a(76825),a(35866);var s=a(23191),r=a(88716),i=a(37922),l=a.n(i),n=a(95231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);a.d(t,o);let d=["",{children:["leasing",{children:["history",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,83848)),"/Users/yoyo/Desktop/adspace 2/app/leasing/history/page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,76825)),"/Users/yoyo/Desktop/adspace 2/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/yoyo/Desktop/adspace 2/app/leasing/history/page.tsx"],m="/leasing/history/page",u={require:a,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/leasing/history/page",pathname:"/leasing/history",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},99924:(e,t,a)=>{Promise.resolve().then(a.bind(a,54248))},54248:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>y});var s=a(10326),r=a(17577),i=a(77109),l=a(35047),n=a(14689),o=a(41726),d=a(66167),c=a(64070);let m=(0,a(76557).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);var u=a(35882),x=a(82610),p=a(98091),h=a(71939);let g=e=>{if(!e?.name)return"bg-gray-100 text-gray-800";switch(e.name){case"Recibido":return"bg-red-100 text-red-800";case"Asignado":return"bg-orange-100 text-orange-800";case"Encendido":return"bg-amber-100 text-amber-800";case"Evidencia Enviada":return"bg-yellow-100 text-yellow-800";case"Reporte Enviado":return"bg-lime-100 text-lime-800";case"Facturado":return"bg-emerald-100 text-emerald-800";case"Completado":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};function y(){let{data:e}=(0,i.useSession)();(0,l.useRouter)();let[t,a]=(0,r.useState)([]),[y,f]=(0,r.useState)(!0),[j,v]=(0,r.useState)(""),[b,N]=(0,r.useState)(null),[w,S]=(0,r.useState)(null),[k,E]=(0,r.useState)(null),{addNotification:M}=(0,h.z)(),P=t.filter(e=>{let t=j.toLowerCase();return!!e.id.toString().includes(t)||e.leases.some(e=>e.id.toString().includes(t)||e.customerName.toLowerCase().includes(t)||e.mediaSpace.store.name.toLowerCase().includes(t)||e.mediaSpace.mediaItem.type.toLowerCase().includes(t))}),_=async e=>{if(confirm("\xbfEst\xe1 seguro de que desea eliminar esta solicitud?")){E(e);try{if(!(await fetch(`/api/orders/${e}`,{method:"DELETE"})).ok)throw Error("Failed to delete order");let s=t.filter(t=>t.id!==e);a(s),M("Solicitud eliminada exitosamente")}catch(e){console.error("Error deleting order:",e),M("Error al eliminar la solicitud")}finally{E(null)}}},A=async e=>{try{let t=await fetch(`/api/leases/${e}`);if(!t.ok)throw Error("Failed to fetch lease details");let a=await t.json();N(a)}catch(e){console.error("Error fetching lease details:",e),M("Error al cargar los detalles del arriendo")}};return y?s.jsx(d.p,{}):(0,s.jsxs)("div",{className:"p-6",children:[s.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Historial de Solicitudes"}),(0,s.jsxs)("div",{className:"relative mb-6",children:[s.jsx(m,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),s.jsx(c.I,{type:"text",placeholder:"Buscar por #orden, #lease, cliente, tienda o tipo de medio...",value:j,onChange:e=>v(e.target.value),className:"pl-10 w-full max-w-xl"})]}),0===P.length?s.jsx("div",{className:"bg-white rounded-lg shadow p-6 text-center text-gray-500",children:j?"No se encontraron resultados":"No hay solicitudes para mostrar"}):s.jsx("div",{className:"space-y-6",children:P.map(e=>{let t=e.leases.reduce((e,t)=>e+t.amount,0);return(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-lg font-semibold",children:["Numero de Orden #",e.id]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Fecha de Creaci\xf3n:",(0,n.Z)(new Date(e.createdAt),"dd MMM yyyy, HH:mm",{locale:o.Z})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)("span",{className:"text-lg font-semibold",children:["$",t.toLocaleString()]}),s.jsx(x.z,{variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>_(e.id),disabled:k===e.id,children:k===e.id?s.jsx("span",{className:"loading loading-spinner loading-sm"}):s.jsx(p.Z,{className:"h-4 w-4"})})]})]}),s.jsx("div",{className:"space-y-4",children:e.leases.map(t=>s.jsx("div",{className:"border rounded-lg p-4 hover:bg-gray-50 cursor-pointer transition-colors",onClick:async()=>{await A(t.id),S(e)},children:(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsxs)("div",{children:[s.jsx("h3",{className:"font-medium",children:t.customerName}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[t.mediaSpace?.store?.name??"Store N/A"," - ",t.mediaSpace?.mediaItem?.type??"Type N/A"]}),s.jsx("p",{className:"text-sm text-gray-600",children:t.extraInformation?.planAlaMedida?(0,s.jsxs)("span",{className:"text-gray-600",children:["Plan a la Medida URL: ",t.extraInformation.planAlaMedida]}):t.mediaSpace?.mediaItem?.dimensions}),(0,s.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,n.Z)(new Date(t.startDate),"d MMM",{locale:o.Z})," - ",(0,n.Z)(new Date(t.endDate),"d MMM yyyy",{locale:o.Z})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[s.jsx("span",{className:`inline-block px-2 py-1 rounded text-sm font-medium ${g(t.status)}`,children:t.status?.name||"Estado Desconocido"}),(0,s.jsxs)("p",{className:"text-sm font-medium mt-1",children:["$",(t.extraInformation?.planAlaMedidaAmount||t.amount).toLocaleString()]})]})]})},t.id))})]},e.id)})}),s.jsx(u.i,{lease:b,orders:w,isOpen:!!b,onClose:()=>N(null)})]})}},98091:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(76557).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},83848:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(68570).createProxy)(String.raw`/Users/yoyo/Desktop/adspace 2/app/leasing/history/page.tsx#default`)}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[8948,8164,4498,3267,3560,4230],()=>a(72349));module.exports=s})();