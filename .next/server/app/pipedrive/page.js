(()=>{var e={};e.id=728,e.ids=[728],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},41171:(e,a,s)=>{"use strict";s.r(a),s.d(a,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>p,pages:()=>c,routeModule:()=>m,tree:()=>o}),s(550),s(76825),s(35866);var t=s(23191),r=s(88716),i=s(37922),n=s.n(i),l=s(95231),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);s.d(a,d);let o=["",{children:["pipedrive",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,550)),"/Users/yoyo/Desktop/adspace 2/app/pipedrive/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,76825)),"/Users/yoyo/Desktop/adspace 2/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/yoyo/Desktop/adspace 2/app/pipedrive/page.tsx"],p="/pipedrive/page",x={require:s,loadChunk:()=>Promise.resolve()},m=new t.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/pipedrive/page",pathname:"/pipedrive",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},57789:(e,a,s)=>{Promise.resolve().then(s.bind(s,41972))},6994:(e,a,s)=>{"use strict";s.d(a,{p:()=>l});var t=s(10326),r=s(77109),i=s(35047),n=s(66167);function l({children:e,allowedRoles:a}){let{data:s,status:l}=(0,r.useSession)();return"loading"===l?t.jsx(n.p,{}):(s?.user&&a.includes(s.user.role)||(0,i.redirect)("/leasing"),t.jsx(t.Fragment,{children:e}))}},83431:(e,a,s)=>{"use strict";s.d(a,{Ol:()=>l,Zb:()=>n,aY:()=>o,ll:()=>d});var t=s(10326),r=s(17577),i=s(77863);let n=r.forwardRef(({className:e,...a},s)=>t.jsx("div",{ref:s,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...a}));n.displayName="Card";let l=r.forwardRef(({className:e,...a},s)=>t.jsx("div",{ref:s,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...a}));l.displayName="CardHeader";let d=r.forwardRef(({className:e,...a},s)=>t.jsx("h3",{ref:s,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...a}));d.displayName="CardTitle";let o=r.forwardRef(({className:e,...a},s)=>t.jsx("div",{ref:s,className:(0,i.cn)("p-6 pt-0",e),...a}));o.displayName="CardContent"},70293:(e,a,s)=>{"use strict";s.d(a,{_:()=>n});var t=s(10326),r=s(17577),i=s(77863);let n=r.forwardRef(({className:e,...a},s)=>t.jsx("label",{ref:s,className:(0,i.cn)("text-sm font-medium leading-none",e),...a}));n.displayName="Label"},41972:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>j});var t=s(10326),r=s(17577),i=s(83431),n=s(66167),l=s(14689),d=s(6994),o=s(82610),c=s(35882),p=s(88378);let x=(0,s(76557).Z)("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);var m=s(11890),h=s(39183),u=s(57446),y=s(64070),f=s(70293),g=s(71939);function j(){let[e,a]=(0,r.useState)([]),[s,j]=(0,r.useState)([]),[v,N]=(0,r.useState)(!0),[b,w]=(0,r.useState)(null),[C,k]=(0,r.useState)(null),[P,S]=(0,r.useState)(!1),[z,E]=(0,r.useState)(""),[_,A]=(0,r.useState)(""),{addNotification:Z}=(0,g.z)(),[O,T]=(0,r.useState)(!1),I=async(a,s,t)=>{let r=e.findIndex(e=>e.id===s);if(-1===r)return;let i="next"===t?r+1:r-1;if(i<0||i>=e.length)return;let n=e[i].id;w(a);try{if(!(await fetch(`/api/leases/${a}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({statusId:n})})).ok)throw Error("Failed to update status");await q()}catch(e){console.error("Error updating lease status:",e),await q()}finally{w(null),await q()}},q=async()=>{N(!0);try{let[e,s]=await Promise.all([fetch("/api/statuses"),fetch("/api/leases")]),t=await e.json(),r=await s.json();a(Array.isArray(t)?t:[]),j(Array.isArray(r)?r:[])}catch(e){console.error("Error fetching data:",e),a([]),j([])}finally{N(!1)}},D=async()=>{T(!0);try{if(z&&!(await fetch("/api/notification-settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({brandId:2,email:z})})).ok)throw Error("Failed to save Novey settings");if(_&&!(await fetch("/api/notification-settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({brandId:3,email:_})})).ok)throw Error("Failed to save Cochez settings");Z("Configuraci\xf3n guardada exitosamente"),S(!1)}catch(e){console.error("Error saving settings:",e),Z("Error al guardar la configuraci\xf3n")}finally{T(!1)}},M=async e=>{try{if(!(await fetch("/api/test-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})})).ok)throw Error("Failed to send test email");Z("Email de prueba enviado correctamente")}catch(e){console.error("Error sending test email:",e),Z("Error al enviar email de prueba")}};return v?t.jsx(n.p,{}):t.jsx(d.p,{allowedRoles:["ADMIN","ASSOCIATE"],children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[t.jsx("h1",{className:"text-2xl font-bold",children:"Pipeline de Solicitudes"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(o.z,{onClick:q,disabled:v,children:"Actualizar"}),t.jsx(o.z,{variant:"ghost",size:"icon",onClick:()=>S(!0),className:"text-gray-400 hover:text-gray-600",children:t.jsx(p.Z,{className:"h-5 w-5"})})]})]}),t.jsx("div",{className:"overflow-x-auto pb-4",children:t.jsx("div",{className:"flex gap-4 min-w-max",children:Array.isArray(e)&&e.filter(e=>7!==e.id).map((a,r)=>(0,t.jsxs)("div",{className:"bg-gray-100 rounded-lg p-4 w-[300px]",children:[t.jsx("h2",{className:"font-semibold mb-4",children:a.name}),t.jsx("div",{className:"space-y-2",children:Array.isArray(s)&&s.filter(e=>e.statusId===a.id).map(s=>(0,t.jsxs)(i.Zb,{className:`p-2 bg-white shadow-sm hover:shadow-md transition-shadow relative ${b===s.id?"opacity-50":""}`,children:[b===s.id&&t.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-50",children:t.jsx(n.p,{})}),(0,t.jsxs)("div",{className:"text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[t.jsx("p",{className:"font-medium truncate",children:s.customerName}),(0,t.jsxs)("div",{className:"flex items-center text-xs text-gray-600 gap-1 truncate",children:[t.jsx("span",{className:"truncate max-w-[120px]",children:s.mediaSpace.store.name}),t.jsx("span",{className:"flex-shrink-0",children:"â€¢"}),t.jsx("span",{className:"truncate",children:s.mediaSpace.mediaItem.type})]})]}),t.jsx("button",{onClick:()=>k(s),className:"p-1 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100 flex-shrink-0",children:t.jsx(x,{size:16})})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between mt-2 pt-2 border-t",children:[(0,t.jsxs)("span",{className:"text-xs text-gray-500 truncate max-w-[150px]",children:[(0,l.Z)(new Date(s.startDate),"dd/MM/yy")," - ",(0,l.Z)(new Date(s.endDate),"dd/MM/yy")]}),(0,t.jsxs)("div",{className:"flex gap-1 flex-shrink-0",children:[t.jsx(o.z,{variant:"ghost",size:"sm",onClick:()=>I(s.id,a.id,"prev"),disabled:0===r||b===s.id,className:"px-1.5 py-0.5 h-auto",children:t.jsx(m.Z,{size:14})}),t.jsx(o.z,{variant:"ghost",size:"sm",onClick:()=>I(s.id,a.id,"next"),disabled:r===e.length-1||b===s.id,className:"px-1.5 py-0.5 h-auto",children:t.jsx(h.Z,{size:14})})]})]})]})]},s.id))})]},a.id))})}),t.jsx(c.i,{lease:C,isOpen:!!C,onClose:()=>k(null)}),t.jsx(u.Vq,{open:P,onOpenChange:S,children:(0,t.jsxs)(u.cZ,{children:[t.jsx(u.fK,{children:t.jsx(u.$N,{children:"Configuraci\xf3n de Notificaciones"})}),(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(f._,{children:"Email para Novey"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[t.jsx(y.I,{type:"email",placeholder:"ejemplo@novey.com",value:z,onChange:e=>E(e.target.value)}),t.jsx(o.z,{variant:"outline",onClick:()=>M(z),disabled:!z,children:"Probar"})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(f._,{children:"Email para Cochez"}),(0,t.jsxs)("div",{className:"flex gap-2",children:[t.jsx(y.I,{type:"email",placeholder:"ejemplo@cochez.com",value:_,onChange:e=>A(e.target.value)}),t.jsx(o.z,{variant:"outline",onClick:()=>M(_),disabled:!_,children:"Probar"})]})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[t.jsx(o.z,{variant:"outline",onClick:()=>S(!1),children:"Cancelar"}),t.jsx(o.z,{onClick:D,disabled:O,children:O?"Guardando...":"Guardar"})]})]})]})})]})})}},11890:(e,a,s)=>{"use strict";s.d(a,{Z:()=>t});let t=(0,s(76557).Z)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},39183:(e,a,s)=>{"use strict";s.d(a,{Z:()=>t});let t=(0,s(76557).Z)("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},550:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>t});let t=(0,s(68570).createProxy)(String.raw`/Users/yoyo/Desktop/adspace 2/app/pipedrive/page.tsx#default`)}};var a=require("../../webpack-runtime.js");a.C(e);var s=e=>a(a.s=e),t=a.X(0,[8948,8164,4498,3267,3560,4230],()=>s(41171));module.exports=t})();