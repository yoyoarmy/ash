"use strict";(()=>{var e={};e.id=1607,e.ids=[1607],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},37732:(e,a,t)=>{t.r(a),t.d(a,{originalPathname:()=>f,patchFetch:()=>x,requestAsyncStorage:()=>p,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>u});var r={};t.r(r),t.d(r,{POST:()=>l});var o=t(49303),n=t(88716),i=t(60670),d=t(87070),s=t(72331);async function l(e){try{let{items:a,userId:t}=await e.json();console.log("Checkout received raw items:",JSON.stringify(a,null,2)),console.log("First item extraInformation:",a[0]?.extraInformation),console.log("Raw checkout request data:",{items:a.map(e=>({spaceId:e.spaceId,extraInformation:{...e.extraInformation,planAlaMedida:e.extraInformation?.planAlaMedida,planAlaMedidaAmount:e.extraInformation?.planAlaMedidaAmount}}))});let r=await s._.$transaction(async e=>{let r=await e.order.create({data:{userId:t}});for(let t of a){console.log("Processing checkout item:",{spaceId:t.spaceId,extraInfo:t.extraInformation,planAlaMedida:t.extraInformation?.planAlaMedida,planAlaMedidaAmount:t.extraInformation?.planAlaMedidaAmount});let a=await e.lease.create({data:{mediaSpaceId:t.spaceId,customerName:t.extraInformation.customerName,startDate:new Date(t.startDate),endDate:new Date(t.endDate),amount:t.amount,statusId:1,orderId:r.id}});await e.leaseExtraInformation.create({data:{leaseId:a.id,providerInfo:t.extraInformation.providerInfo||"",productDetails:t.extraInformation.productDetails||"",campaignRedirect:t.extraInformation.campaignRedirect||"",marketingGoals:t.extraInformation.marketingGoals||"",disclaimer:t.extraInformation.disclaimer||"",productUrl:t.extraInformation.productUrl||"",targetAudience:t.extraInformation.targetAudience||"",brandGraphics:t.extraInformation.brandGraphics||"",providerContact:t.extraInformation.providerContact||"",billingType:t.extraInformation.billingType||[],giftCampaignDetails:t.extraInformation.giftCampaignDetails||"",planAlaMedida:t.extraInformation.planAlaMedida??null,planAlaMedidaAmount:t.extraInformation.planAlaMedidaAmount??null}}),await e.mediaSpace.update({where:{id:t.spaceId},data:{status:"leased"}})}return r});return d.NextResponse.json(r)}catch(e){return console.error("Detailed error in checkout:",e),d.NextResponse.json({error:"Failed to create order and leases"},{status:500})}}let c=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/checkout/route",pathname:"/api/checkout",filename:"route",bundlePath:"app/api/checkout/route"},resolvedPagePath:"/Users/yoyo/Desktop/adspace 2/app/api/checkout/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:p,staticGenerationAsyncStorage:u,serverHooks:m}=c,f="/api/checkout/route";function x(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:u})}},72331:(e,a,t)=>{t.d(a,{_:()=>o});var r=t(53524);let o=globalThis.prisma??new r.PrismaClient({log:["query"]})}};var a=require("../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),r=a.X(0,[8948,5972],()=>t(37732));module.exports=r})();