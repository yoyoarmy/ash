"use strict";(()=>{var e={};e.id=7963,e.ids=[7963],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},60598:(e,a,t)=>{t.r(a),t.d(a,{originalPathname:()=>f,patchFetch:()=>w,requestAsyncStorage:()=>c,routeModule:()=>p,serverHooks:()=>h,staticGenerationAsyncStorage:()=>m});var r={};t.r(r),t.d(r,{DELETE:()=>u,GET:()=>l});var s=t(49303),i=t(88716),n=t(60670),o=t(87070),d=t(72331);async function u(e,{params:a}){try{let e=parseInt(a.id);return await d._.$transaction(async a=>{let t=await a.lease.findUnique({where:{id:e},select:{mediaSpaceId:!0}});if(!t)throw Error("Lease not found");await a.leaseExtraInformation.deleteMany({where:{leaseId:e}}),await a.lease.delete({where:{id:e}});let r=await a.lease.findMany({where:{mediaSpaceId:t.mediaSpaceId,status:{in:["active","pending"]}}});0===r.length&&await a.mediaSpace.update({where:{id:t.mediaSpaceId},data:{status:"available"}})}),o.NextResponse.json({message:"Lease revoked successfully"})}catch(e){return console.error("Error revoking lease:",e),o.NextResponse.json({error:"Failed to revoke lease"},{status:500})}}async function l(e,{params:a}){try{let e=parseInt(a.id),t=await d._.lease.findUnique({where:{id:e},include:{mediaSpace:{include:{store:!0,mediaItem:!0}},status:!0,order:{include:{user:!0}},extraInformation:!0}});if(!t)return o.NextResponse.json({error:"Lease not found"},{status:404});return o.NextResponse.json(t)}catch(e){return console.error("Error fetching lease:",e),o.NextResponse.json({error:"Failed to fetch lease"},{status:500})}}let p=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/leases/[id]/route",pathname:"/api/leases/[id]",filename:"route",bundlePath:"app/api/leases/[id]/route"},resolvedPagePath:"/Users/yoyo/Desktop/adspace 2/app/api/leases/[id]/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:c,staticGenerationAsyncStorage:m,serverHooks:h}=p,f="/api/leases/[id]/route";function w(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:m})}},72331:(e,a,t)=>{t.d(a,{_:()=>s});var r=t(53524);let s=globalThis.prisma??new r.PrismaClient({log:["query"]})}};var a=require("../../../../webpack-runtime.js");a.C(e);var t=e=>a(a.s=e),r=a.X(0,[8948,5972],()=>t(60598));module.exports=r})();