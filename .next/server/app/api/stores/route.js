"use strict";(()=>{var e={};e.id=6593,e.ids=[6593],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},96543:(e,r,o)=>{o.r(r),o.d(r,{originalPathname:()=>D,patchFetch:()=>f,requestAsyncStorage:()=>p,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>g});var t={};o.r(t),o.d(t,{GET:()=>u,POST:()=>l});var n=o(49303),s=o(88716),a=o(60670),i=o(87070),d=o(72331);async function l(e){try{let r=await e.json();if(console.log("Received store data:",r),!r.name||!r.location||!r.brandId)return i.NextResponse.json({error:"Missing required fields"},{status:400});let o=await d._.store.create({data:{name:r.name,location:r.location,brandId:r.brandId,mediaSpaces:{create:[]}}});return console.log("Created store:",o),i.NextResponse.json(o)}catch(r){let e=r instanceof Error?r.message:"Unknown error";return console.log("Error creating store:",e),i.NextResponse.json({error:"Failed to create store",message:e},{status:500})}}async function u(e){try{let{searchParams:r}=new URL(e.url),o=r.get("brandId");console.log("\n=== STORES API CALLED ==="),console.log("\uD83D\uDD0D URL:",e.url),console.log("\uD83D\uDD0D brandIdParam:",o,"type:",typeof o);let t=o?parseInt(o,10):NaN;if(console.log("\uD83D\uDD0D Parsed brandId:",t,"type:",typeof t),isNaN(t)){console.log("\uD83D\uDCCB No valid brandId, returning ALL stores");let e=await d._.store.findMany({include:{mediaSpaces:{include:{mediaItem:{include:{mediaItemType:!0}},leases:{where:{endDate:{gte:new Date}}}}},brand:!0}});return console.log(`ðŸ“‹ Found ${e.length} total stores`),i.NextResponse.json(e)}let n=await d._.brand.findUnique({where:{id:t},select:{id:!0,name:!0}});if(console.log("\uD83C\uDFE2 Found brand:",JSON.stringify(n,null,2)),!n)return console.log("âŒ No brand found for brandId:",t),i.NextResponse.json([]);if(1===n.id){console.log("\uD83D\uDD04 Brand is Novey y Cochez, fetching stores for brands 2 and 3");let e=await d._.store.findMany({where:{brandId:{in:[2,3]}},include:{mediaSpaces:{include:{mediaItem:{include:{mediaItemType:!0}},leases:{where:{endDate:{gte:new Date}}}}},brand:!0}});return console.log(`âœ… Found ${e.length} stores for Novey y Cochez`),i.NextResponse.json(e)}console.log("\uD83C\uDFAF Filtering by specific brandId:",t);let s=await d._.store.findMany({where:{brandId:t},include:{mediaSpaces:{include:{mediaItem:{include:{mediaItemType:!0}},leases:{where:{endDate:{gte:new Date}}}}},brand:!0}});return console.log(`âœ… Found ${s.length} stores for brand ${t}`),i.NextResponse.json(s)}catch(e){return console.error("âŒ Error in GET /stores:",e),i.NextResponse.json({error:"Failed to fetch stores"},{status:500})}}let c=new n.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/stores/route",pathname:"/api/stores",filename:"route",bundlePath:"app/api/stores/route"},resolvedPagePath:"/Users/yoyo/Desktop/adspace 2/app/api/stores/route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:p,staticGenerationAsyncStorage:g,serverHooks:m}=c,D="/api/stores/route";function f(){return(0,a.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:g})}},72331:(e,r,o)=>{o.d(r,{_:()=>n});var t=o(53524);let n=globalThis.prisma??new t.PrismaClient({log:["query"]})}};var r=require("../../../webpack-runtime.js");r.C(e);var o=e=>r(r.s=e),t=r.X(0,[8948,5972],()=>o(96543));module.exports=t})();