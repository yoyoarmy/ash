"use strict";(()=>{var e={};e.id=1385,e.ids=[1385],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},60879:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>m,patchFetch:()=>l,requestAsyncStorage:()=>d,routeModule:()=>i,serverHooks:()=>c,staticGenerationAsyncStorage:()=>u});var r={};a.r(r),a.d(r,{GET:()=>p});var s=a(49303),n=a(88716),o=a(60670);async function p(e){try{let{searchParams:t}=new URL(e.url),a=t.get("brandId"),r=t.get("mediaItemTypeId"),s=(await prisma.mediaSpace.findMany({where:{store:a?{brandId:parseInt(a)}:void 0,mediaItem:r?{mediaItemTypeId:parseInt(r)}:void 0},include:{mediaItem:!0,store:!0,leases:{where:{AND:[{status:{name:{not:"Completado"}}},{endDate:{gte:new Date}}]}}}})).map(e=>{let t=e.leases.length,a=e.mediaItem.capacity,r=a-t;return{...e,availableSlots:r,isAtCapacity:r<=0,currentCapacity:`${t}/${a}`}});return NextResponse.json(s)}catch(e){return console.error("Error fetching spaces:",e),NextResponse.json({error:"Failed to fetch spaces"},{status:500})}}let i=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/spaces/route",pathname:"/api/spaces",filename:"route",bundlePath:"app/api/spaces/route"},resolvedPagePath:"/Users/yoyo/Desktop/adspace 2/app/api/spaces/route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:d,staticGenerationAsyncStorage:u,serverHooks:c}=i,m="/api/spaces/route";function l(){return(0,o.patchFetch)({serverHooks:c,staticGenerationAsyncStorage:u})}},49303:(e,t,a)=>{e.exports=a(30517)}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[8948],()=>a(60879));module.exports=r})();